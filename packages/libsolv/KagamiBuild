# Description: Library for solving packages and reading repositories
# URL:         https://github.com/openSUSE/libsolv
# Maintainer:  protonesso, nagakamira at gmail dot com
# Depends on:  cmake ninja swig perl python bzip2 expat rpm xz
# Section:     libs

name=libsolv
version=0.7.14
release=2
source=("https://github.com/openSUSE/libsolv/archive/$version.tar.gz")

build() {
	export CFLAGS="-I$STUFF/include $CFLAGS"
	export CXXFLAGS="-I$STUFF/include $CXXFLAGS"

	cd "$SRC"/$name-$version
	mkdir -p build
	cd build
	cmake "$SRC"/$name-$version \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=/usr/lib \
		-DCMAKE_BUILD_TYPE=MinSizeRel \
		-DWITH_SYSTEM_ZCHUNK=OFF \
		-DENABLE_RUBY=OFF \
		-DENABLE_TCL=OFF \
		-DFEDORA=ON \
		-Wno-dev -G Ninja
	ninja
	DESTDIR="$PKG" ninja install

	mkdir -p "$PKG"/usr/lib/cmake/LibSolv/
	mv "$PKG"/usr/share/cmake/Modules/FindLibSolv.cmake "$PKG"/usr/lib/cmake/LibSolv/LibSolvConfig.cmake
}
